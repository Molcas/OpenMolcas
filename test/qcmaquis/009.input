*-------------------------------------------------------------------------------
* Molecule: C2H2
* Basis: cc-pVDZ
* Symmetry: C1
* Features tested: NEVPT2
* Responsible person: L. Freitag
* Comments: DMRG-NEVPT2 and QD-NEVPT2 test for C2H2, CAS(4,4), 2 states
*-------------------------------------------------------------------------------

>> RM -FORCE TEST_QCMAQUIS
>> IF ( $MOLCAS_DRIVER = UNKNOWN_VARIABLE )
>>   EXPORT MOLCAS_DRIVER=molcas
>> ENDIF
>> SHELL $MOLCAS_DRIVER have_feature qcmaquis || touch TEST_QCMAQUIS
>> IF ( -FILE TEST_QCMAQUIS )
>>   EXIT 36
>> ENDIF

&GATEWAY
 coord
 4
 ang
 H   0.0000000000   0.0000000000  -1.6450541782
 C   0.0000000000   0.0000000000  -0.5832481605
 C   0.0000000000   0.0000000000   0.5832481606
 H   0.0000000000   0.0000000000   1.6450541782
 basis=cc-pvdz
 group=NOSYM
 RICD
&SEWARD

&SCF
&DMRGSCF
 ActiveSpaceOptimizer=QCMaquis
OOptimizationSettings
 nactel = 4,0,0
 inactive = 5
     RAS2 = 4
  CIROOT=2,2,1
  Alter
  1
  1 8 10
  NEVPT2Prep
  SOCC
  2200
  2ud0
EndOOptimizationSettings
DMRGSettings
    nsweeps = 20
    max_bond_dimension = 100
EndDMRGSettings
&MOTRA
Frozen=0
CTonly
Kpq
HDF5

* Test NEVPT2 calculating the RDMs on the fly
&NEVPT2
States=2

* Test the RDM reading feature by rerunning NEVPT2 with RDMRead option
&NEVPT2
States=2
RDMRead

>>FILE checkfile
* This file is autogenerated:
* Molcas version 25.10-206-g8c44e7b2e
* Linux pauli 6.18.4-arch1-1 #1 SMP PREEMPT_DYNAMIC Fri, 09 Jan 2026 19:43:48 +0000 x86_64 GNU/Linux
* Wed Jan 14 15:30:48 2026
*
#>>   1
#> POTNUC="25.322375896970"/12
#>>   2
#> POTNUC="25.322375896970"/12
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="0.499289232500"/5
#> SEWARD_ATTRACT="-5.412381509933"/5
#>>   3
#> SCF_ITER="9"/8
#> E_SCF="-76.824481552713"/4
#> MLTPL__0="-0.000000000000"/2
#> MLTPL__1[0]="0.0"/2
#> MLTPL__1[1]="0.0"/2
#> MLTPL__1[2]="0.000000004551"/2
#> MLTPL__2[0]="-2.488416066156"/2
#> MLTPL__2[1]="0.0"/2
#> MLTPL__2[2]="0.0"/2
#> MLTPL__2[3]="-2.488416066156"/2
#> MLTPL__2[4]="0.0"/2
#> MLTPL__2[5]="4.976832132313"/2
#>>   4
#> RASSCF_ITER="9"/8
#> E_RASSCF[0]="-76.879930775074"/6
#> E_RASSCF[1]="-76.575755760620"/6
#> MLTPL__0="-0.000000000000"/2
#> MLTPL__1[0]="0.0"/2
#> MLTPL__1[1]="0.0"/2
#> MLTPL__1[2]="-0.000000000844"/2
#> MLTPL__2[0]="-2.391597385824"/2
#> MLTPL__2[1]="0.000000000002"/2
#> MLTPL__2[2]="0.0"/2
#> MLTPL__2[3]="-2.391597385826"/2
#> MLTPL__2[4]="0.0"/2
#> MLTPL__2[5]="4.783194771649"/2
#> MLTPL__0="-0.000000000000"/2
#> MLTPL__1[0]="0.0"/2
#> MLTPL__1[1]="0.0"/2
#> MLTPL__1[2]="-0.000000001056"/2
#> MLTPL__2[0]="-1.632328166467"/2
#> MLTPL__2[1]="0.000000000003"/2
#> MLTPL__2[2]="0.0"/2
#> MLTPL__2[3]="-1.632328166573"/2
#> MLTPL__2[4]="0.0"/2
#> MLTPL__2[5]="3.264656333040"/2
#>>   5
#>>   6
#> E_SC_NEVPT2[0]="-77.074185486785"/6
#> E_SC_NEVPT2[1]="0.000000000001"/6
#> E_PC_NEVPT2[0]="-77.074413556072"/6
#> E_PC_NEVPT2[1]="-0.000000000000"/6
#>>   7
#> E_SC_NEVPT2[0]="-77.074185486785"/6
#> E_SC_NEVPT2[1]="0.000000000001"/6
#> E_PC_NEVPT2[0]="-77.074413556072"/6
#> E_PC_NEVPT2[1]="-0.000000000000"/6
>>EOF
