*-------------------------------------------------------------------------------
* Molecule: Water dimer
* Basis: cc-pVDZ
* Symmetry: C1
* Features tested: Molcas/Gromacs interface
* Responsible person: Michael Stenrup
* Comments: Only run test if interface is installed
*-------------------------------------------------------------------------------
* Test if Gromacs is available and skip the test if not
> RM -FORCE TEST_GROMACS
> IF ( $MOLCAS_DRIVER = UNKNOWN_VARIABLE )
>   EXPORT MOLCAS_DRIVER=molcas
> ENDIF
> SHELL $MOLCAS_DRIVER have_feature gromacs || touch TEST_GROMACS
> IF ( -FILE TEST_GROMACS )
>   EXIT 36
> ENDIF
*-------------------------------------------------------------------------------
> FILE conf.gro
Water dimer
   6
    1SOLQM   OW    1   -.155   -.011    .000
    1SOLQM  HW1    2   -.193    .076    .000
    1SOLQM  HW2    3   -.039   -.012   -.000
    2SOL     OW    4    .224    .016    .116
    2SOL    HW1    5    .264   -.036    .046
    2SOL    HW2    6    .253   -.035    .177
   1.0 1.0 1.0
> EOF
*-------------------------------------------------------------------------------
> FILE index.ndx
[ System ]
 1 2 3 4 5 6
[ QM ]
 1 2 3
[ MM ]
 4 5 6
> EOF
*-------------------------------------------------------------------------------
> FILE topol.top
#include "oplsaa.ff/forcefield.itp"
#include "oplsaa.ff/spc.itp"
#include "spcqm.itp"

[ system ]
 Water dimer

[ molecules ]
 SOLQM 1
 SOL 1
> EOF
*-------------------------------------------------------------------------------
> FILE spcqm.itp
[ moleculetype ]
 SOLQM 2

[ atoms ]
 1 opls_116 1 SOLQM  OW 1 -0.82
 2 opls_117 1 SOLQM HW1 1  0.41
 3 opls_117 1 SOLQM HW2 1  0.41

[ bonds ]
 1 2 5
 1 3 5
> EOF
*-------------------------------------------------------------------------------
> FILE grompp.mdp
define = -DFLEXIBLE

cutoff-scheme = group
pbc = no
rlist = 0

coulombtype = cut-off
rcoulomb = 0

vdwtype = cut-off
rvdw = 0

QMMM = yes
QMMM-grps = QM
QMMMscheme = slave
QMmethod = CASSCF
QMbasis = STO-3G
> EOF
*-------------------------------------------------------------------------------
> SHELL grompp_d -n index
> EXPORT GMX_NB_GENERIC=1
> EXPORT GMX_MAXBACKUP=-1

&GATEWAY
Gromacs
 Simple
Basis
 cc-pVDZ
Group
 NoSym
NoCD

> DO WHILE

&SEWARD

&ESPF
External
 Gromacs
MMIterations
 1000

&SCF

&SLAPAF
Cartesian

> ENDDO
>>FILE checkfile
* This file is autogenerated:
* Molcas version 19.11-191-g003553fb
* Linux serrano 3.13.0-162-generic #212-Ubuntu SMP Mon Oct 29 12:08:50 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux
* Mon May 11 13:36:33 2020
*
#>>   1
#> POTNUC="8.406904165079"/12
#>>   2
#> POTNUC="8.406904165079"/6
#> SEWARD_MLTPL1X="-2.929075493170"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.151990197910"/5
#>>   3
#> POTNUC="8.330488832533"/6
#>>   4
#> SCF_ITER="10"/8
#> E_SCF="-75.970962302007"/8
#> ESPF_MULTIPOLES[0]="-0.752820096086"/6
#> ESPF_MULTIPOLES[1]="0.386250889294"/6
#> ESPF_MULTIPOLES[2]="0.366389942735"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.514593287981"/5
#> MLTPL__1[1]="0.613221017850"/5
#> MLTPL__1[2]="0.0"/5
#> MLTPL__2[0]="1.888518000998"/5
#> MLTPL__2[1]="-1.190723807540"/5
#> MLTPL__2[2]="0.0"/5
#> MLTPL__2[3]="0.040538519192"/5
#> MLTPL__2[4]="0.0"/5
#> MLTPL__2[5]="-1.929056520190"/5
#>>   5
#> GRAD[0]="-0.115071545502"/6
#> GRAD[1]="0.019677516499"/6
#> GRAD[2]="0.0"/6
#> GRAD[3]="-0.021208716273"/6
#> GRAD[4]="-0.002032951735"/6
#> GRAD[5]="0.0"/6
#> GRAD[6]="0.136280261775"/6
#> GRAD[7]="-0.017644564764"/6
#> GRAD[8]="0.0"/6
#> GRAD[0]="-0.111080115286"/6
#> GRAD[1]="0.022570624867"/6
#> GRAD[2]="0.000909608877"/6
#> GRAD[3]="-0.020148849201"/6
#> GRAD[4]="-0.004584954806"/6
#> GRAD[5]="-0.000382971619"/6
#> GRAD[6]="0.130114236068"/6
#> GRAD[7]="-0.018539509168"/6
#> GRAD[8]="-0.001527677522"/6
#>>   6
#>>   7
#>>   9
#> POTNUC="8.956226282463"/6
#> SEWARD_MLTPL1X="-2.899537103413"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.216082434582"/5
#>>  10
#> POTNUC="8.640373766419"/6
#>>  11
#> SCF_ITER="9"/8
#> E_SCF="-76.033034018224"/8
#> ESPF_MULTIPOLES[0]="-0.802804336717"/6
#> ESPF_MULTIPOLES[1]="0.369094548058"/6
#> ESPF_MULTIPOLES[2]="0.433940404268"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.592738088233"/5
#> MLTPL__1[1]="0.664997933040"/5
#> MLTPL__1[2]="0.000743860613"/5
#> MLTPL__2[0]="1.485558305810"/5
#> MLTPL__2[1]="-0.850316598545"/5
#> MLTPL__2[2]="0.007600159308"/5
#> MLTPL__2[3]="0.248901728778"/5
#> MLTPL__2[4]="-0.000973787873"/5
#> MLTPL__2[5]="-1.734460034588"/5
#>>  12
#> GRAD[0]="-0.074123363782"/6
#> GRAD[1]="-0.010350937751"/6
#> GRAD[2]="-0.000576976013"/6
#> GRAD[3]="-0.012179941610"/6
#> GRAD[4]="0.009913355455"/6
#> GRAD[5]="0.000005419391"/6
#> GRAD[6]="0.086303305393"/6
#> GRAD[7]="0.000437582296"/6
#> GRAD[8]="0.000571556622"/6
#> GRAD[0]="-0.045591846977"/6
#> GRAD[1]="-0.002249577359"/6
#> GRAD[2]="0.001025839800"/6
#> GRAD[3]="-0.008540279909"/6
#> GRAD[4]="0.004617689832"/6
#> GRAD[5]="0.000036689104"/6
#> GRAD[6]="0.052809498270"/6
#> GRAD[7]="-0.002266248430"/6
#> GRAD[8]="-0.001751580498"/6
#>>  13
#>>  14
#>>  16
#> POTNUC="9.439092546436"/6
#> SEWARD_MLTPL1X="-2.875903544490"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.273412206170"/5
#>>  17
#> POTNUC="9.148719700189"/6
#>>  18
#> SCF_ITER="8"/8
#> E_SCF="-76.034899849493"/8
#> ESPF_MULTIPOLES[0]="-0.800752635613"/6
#> ESPF_MULTIPOLES[1]="0.369094562779"/6
#> ESPF_MULTIPOLES[2]="0.431956459823"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.532643994398"/5
#> MLTPL__1[1]="0.674657634996"/5
#> MLTPL__1[2]="0.008369677736"/5
#> MLTPL__2[0]="1.129078302718"/5
#> MLTPL__2[1]="-0.763673697762"/5
#> MLTPL__2[2]="0.036644643165"/5
#> MLTPL__2[3]="0.437781182038"/5
#> MLTPL__2[4]="-0.007956335884"/5
#> MLTPL__2[5]="-1.566859484756"/5
#>>  19
#> GRAD[0]="0.022543787180"/6
#> GRAD[1]="-0.008361948155"/6
#> GRAD[2]="0.000324047736"/6
#> GRAD[3]="-0.003286024855"/6
#> GRAD[4]="0.007324099058"/6
#> GRAD[5]="-0.000035064678"/6
#> GRAD[6]="-0.019257762325"/6
#> GRAD[7]="0.001037849097"/6
#> GRAD[8]="-0.000288983058"/6
#> GRAD[0]="0.045763448641"/6
#> GRAD[1]="0.000957000105"/6
#> GRAD[2]="0.001449752355"/6
#> GRAD[3]="-0.000298306237"/6
#> GRAD[4]="0.001525309165"/6
#> GRAD[5]="0.000091161349"/6
#> GRAD[6]="-0.045968949165"/6
#> GRAD[7]="-0.002574048352"/6
#> GRAD[8]="-0.001879413889"/6
#>>  20
#>>  21
#>>  23
#> POTNUC="9.224007532773"/6
#> SEWARD_MLTPL1X="-2.886192662632"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.247625388571"/5
#>>  24
#> POTNUC="8.922797683053"/6
#>>  25
#> SCF_ITER="8"/8
#> E_SCF="-76.036429908966"/8
#> ESPF_MULTIPOLES[0]="-0.797533521517"/6
#> ESPF_MULTIPOLES[1]="0.367964852554"/6
#> ESPF_MULTIPOLES[2]="0.429828254831"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.563085866362"/5
#> MLTPL__1[1]="0.672715938805"/5
#> MLTPL__1[2]="0.009366434424"/5
#> MLTPL__2[0]="1.265787548471"/5
#> MLTPL__2[1]="-0.768705644766"/5
#> MLTPL__2[2]="0.042833837304"/5
#> MLTPL__2[3]="0.365728226834"/5
#> MLTPL__2[4]="-0.009193670737"/5
#> MLTPL__2[5]="-1.631515775304"/5
#>>  26
#> GRAD[0]="-0.032525305385"/6
#> GRAD[1]="-0.008503177648"/6
#> GRAD[2]="-0.000458814517"/6
#> GRAD[3]="-0.004417603568"/6
#> GRAD[4]="0.005204469473"/6
#> GRAD[5]="-0.000062835459"/6
#> GRAD[6]="0.036942908953"/6
#> GRAD[7]="0.003298708175"/6
#> GRAD[8]="0.000521649976"/6
#> GRAD[0]="-0.007230189597"/6
#> GRAD[1]="0.000658824528"/6
#> GRAD[2]="0.000784150271"/6
#> GRAD[3]="-0.001318869333"/6
#> GRAD[4]="-0.000436836832"/6
#> GRAD[5]="0.000071830980"/6
#> GRAD[6]="0.007512472029"/6
#> GRAD[7]="-0.000228103108"/6
#> GRAD[8]="-0.001396614103"/6
#>>  27
#>>  28
#>>  30
#> POTNUC="9.254177842779"/6
#> SEWARD_MLTPL1X="-2.883213782437"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.251144404875"/5
#>>  31
#> POTNUC="8.952865371412"/6
#>>  32
#> SCF_ITER="8"/8
#> E_SCF="-76.036502595509"/8
#> ESPF_MULTIPOLES[0]="-0.796937564518"/6
#> ESPF_MULTIPOLES[1]="0.367405350238"/6
#> ESPF_MULTIPOLES[2]="0.429790303231"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.562166397168"/5
#> MLTPL__1[1]="0.673364195145"/5
#> MLTPL__1[2]="0.012355187870"/5
#> MLTPL__2[0]="1.237352733554"/5
#> MLTPL__2[1]="-0.756846888854"/5
#> MLTPL__2[2]="0.057521976913"/5
#> MLTPL__2[3]="0.382738194718"/5
#> MLTPL__2[4]="-0.013083175581"/5
#> MLTPL__2[5]="-1.620090928272"/5
#>>  33
#> GRAD[0]="-0.026477339565"/6
#> GRAD[1]="-0.009084994296"/6
#> GRAD[2]="-0.000494670219"/6
#> GRAD[3]="-0.003559520455"/6
#> GRAD[4]="0.005347342966"/6
#> GRAD[5]="-0.000069679004"/6
#> GRAD[6]="0.030036860020"/6
#> GRAD[7]="0.003737651331"/6
#> GRAD[8]="0.000564349223"/6
#> GRAD[0]="-0.001166764060"/6
#> GRAD[1]="0.000223327517"/6
#> GRAD[2]="0.000794308302"/6
#> GRAD[3]="-0.000515549301"/6
#> GRAD[4]="-0.000338975862"/6
#> GRAD[5]="0.000094054310"/6
#> GRAD[6]="0.000780256657"/6
#> GRAD[7]="0.000138848420"/6
#> GRAD[8]="-0.001354118159"/6
#>>  34
#> GEO_ITER="5"/8
#> POTNUC="9.262704586862"/6
#> SEWARD_MLTPL1X="-2.880437714064"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.252114198462"/5
#> POTNUC="8.961114710311"/6
#> SCF_ITER="7"/8
#> E_SCF="-76.036548954158"/8
#> ESPF_MULTIPOLES[0]="-0.797498061270"/6
#> ESPF_MULTIPOLES[1]="0.367596953568"/6
#> ESPF_MULTIPOLES[2]="0.430198182510"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.563336355999"/5
#> MLTPL__1[1]="0.673062899393"/5
#> MLTPL__1[2]="0.016516595709"/5
#> MLTPL__2[0]="1.223370245601"/5
#> MLTPL__2[1]="-0.750528948679"/5
#> MLTPL__2[2]="0.079119859414"/5
#> MLTPL__2[3]="0.392607185483"/5
#> MLTPL__2[4]="-0.019110868820"/5
#> MLTPL__2[5]="-1.615977431083"/5
#>>  35
#>>  36
>>EOF
